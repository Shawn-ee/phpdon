webpackJsonp([55],{MItE:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("mvHQ"),a=r.n(i),s=r("Gu7T"),o=r.n(s),l=r("Xxa5"),n=r.n(l),u=r("exGp"),c=r.n(u),m={data:function(){return{base_city:[],id:"",navTitle:"",showMap:!1,have_user_id:!1,subForm:{id:0,user_id:0,nickName:"",coach_name:"",mobile:"",sex:0,work_time:"",city_id:"",lng:"",lat:"",address:"",text:"",id_code:"",id_card:[],license:[],work_img:[],self_img:[],video:"",status:2,order_num:0},subFormRules:{coach_name:{required:!0,validator:this.$reg.isNotNull,text:"技师姓名",reg_type:2,trigger:"blur"},mobile:{required:!0,validator:this.$reg.isTel,text:"手机号",reg_type:2,trigger:"blur"},sex:{required:!0,type:"number",message:"请选择",trigger:"blur"},work_time:{required:!0,type:"number",message:"请输入从业年份",trigger:"blur"},city_id:{required:!0,type:"number",message:"请选择意向工作城市",trigger:"blur"},address:{required:!0,type:"string",message:"请输入地址",trigger:"blur"},lng:{required:!0,validator:this.$reg.isLng,trigger:"blur"},lat:{required:!0,validator:this.$reg.isLat,trigger:"blur"},id_code:{required:!0,validator:this.$reg.isIdCard,trigger:"blur"},text:{required:!0,type:"string",message:"请输入技师简介",trigger:"blur"},id_card:{required:!0,type:"array",message:"请上传图片",trigger:"blur"},license:{required:!0,type:"array",message:"请上传图片",trigger:"blur"},work_img:{required:!0,type:"array",message:"请上传图片",trigger:"blur"},self_img:{required:!0,type:"array",message:"请上传图片",trigger:"blur"},order_num:{required:!0,validator:this.$reg.isNum,trigger:"blur"}},searchForm:{page:1,limit:10,nickName:""},total:0,loading:!1,tableData:[],currentRow:{},showDialog:!1}},created:function(){var e=this.$route.query.id;e&&(this.subForm.id=e,this.getDetail(e)),this.navTitle=this.$t(e?"menu.TechnicianEdit":"menu.TechnicianAdd"),this.getCityList()},methods:{getCityList:function(){var e=this;return c()(n.a.mark(function t(){var r,i,a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$api.system.citySelect();case 2:if(r=t.sent,i=r.code,a=r.data,200===i){t.next=7;break}return t.abrupt("return");case 7:e.base_city=a;case 8:case"end":return t.stop()}},t,e)}))()},getCover:function(e,t){this.subForm[t]=e},getBannerList:function(e,t){var r;(r=this.subForm[t]).push.apply(r,o()(e))},getLatLng:function(e){this.subForm.lat=e.lat,this.subForm.lng=e.lng},getDetail:function(e){var t=this;return c()(n.a.mark(function r(){var i,a,s,o;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$api.technician.coachInfo({id:e});case 2:if(i=r.sent,a=i.code,s=i.data,200===a){r.next=7;break}return r.abrupt("return");case 7:for(o in s.nickName=s.user_id?s.nickName||"用户ID "+s.user_id:"",s.work_img=[{url:s.work_img}],["id_card","license","self_img"].map(function(e){s[e]=s[e].map(function(e){return{url:e}})}),t.subForm)t.subForm[o]=s[o];t.have_user_id=s.id&&s.user_id;case 13:case"end":return r.stop()}},r,t)}))()},getVoice:function(e){var t=e.length-1;this.subForm.video=e[t].url},toShowDialog:function(){var e=this;return c()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.have_user_id){t.next=3;break}return t.abrupt("return");case 3:return e.searchForm.nickName="",t.next=6,e.getTableDataList();case 6:e.showDialog=!e.showDialog;case 7:case"end":return t.stop()}},t,e)}))()},resetForm:function(e){this.$refs[e].resetFields(),this.getTableDataList(1)},handleSizeChange:function(e){this.searchForm.limit=e,this.handleCurrentChange(1)},handleCurrentChange:function(e){this.searchForm.page=e,this.getTableDataList()},getTableDataList:function(e){var t=this;return c()(n.a.mark(function r(){var i,s,o,l;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e&&(t.searchForm.page=1),t.loading=!0,i=JSON.parse(a()(t.searchForm)),r.next=5,t.$api.technician.coachUserList(i);case 5:if(s=r.sent,o=s.code,l=s.data,t.loading=!1,200===o){r.next=11;break}return r.abrupt("return");case 11:t.tableData=l.data,t.total=l.total;case 13:case"end":return r.stop()}},r,t)}))()},handleSelectionChange:function(e){var t=e=JSON.parse(a()(e)),r=t.id,i=t.nickName;e.nickName=i||"用户ID "+r,this.currentRow=e},handleDialogConfirm:function(){if(null!==this.currentRow&&this.currentRow.id){var e=this.currentRow,t=e.id,r=void 0===t?0:t,i=e.nickName,a=void 0===i?"":i;this.subForm.user_id=r,this.subForm.nickName=a,this.showDialog=!1}else this.$message.error("请选择用户")},submitForm:function(){var e=this,t=!0;if(this.$refs.subForm.validate(function(e){e||(t=!1)}),t){var r=JSON.parse(a()(this.subForm));if(r.id_card.length<3)return void this.$message.error("身份证照片请分别上传身份证人像面、身份证国徽面、手持身份证照片");["id_card","license","self_img"].map(function(e){r[e]=r[e].map(function(e){return e.url})}),r.work_img=r.work_img[0].url,delete r.nickName,this.$api.technician.coachAdd(r).then(function(t){200===t.code&&(e.$message.success(e.$t(r.id?"tips.successRev":"tips.successSub")),e.$router.back(-1))})}}}},d={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"lb-system-banner-edit"},[r("top-nav",{attrs:{title:e.navTitle,isBack:!0}}),e._v(" "),r("div",{staticClass:"page-main"},[r("el-form",{ref:"subForm",attrs:{model:e.subForm,rules:e.subFormRules,"label-width":"130px"},nativeOn:{submit:function(e){e.preventDefault()}}},[r("el-form-item",{attrs:{label:"关联用户",prop:"user_id"}},[r("el-tag",{staticClass:"cursor-pointer",attrs:{type:e.have_user_id?"info":"primary"},on:{click:e.toShowDialog}},[e._v(e._s(e.subForm.user_id?e.subForm.nickName:"选择关联用户"))])],1),e._v(" "),r("el-form-item",{attrs:{label:"技师姓名",prop:"coach_name"}},[r("el-input",{attrs:{maxlength:"15","show-word-limit":"",placeholder:"请输入技师姓名"},model:{value:e.subForm.coach_name,callback:function(t){e.$set(e.subForm,"coach_name",t)},expression:"subForm.coach_name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"性别",prop:"sex"}},[r("el-radio-group",{model:{value:e.subForm.sex,callback:function(t){e.$set(e.subForm,"sex",t)},expression:"subForm.sex"}},[r("el-radio",{attrs:{label:0}},[e._v("男")]),e._v(" "),r("el-radio",{attrs:{label:1}},[e._v("女")])],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[r("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.subForm.mobile,callback:function(t){e.$set(e.subForm,"mobile",t)},expression:"subForm.mobile"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"从业年份",prop:"work_time"}},[r("el-input",{attrs:{placeholder:"请输入从业年份"},model:{value:e.subForm.work_time,callback:function(t){e.$set(e.subForm,"work_time",e._n(t))},expression:"subForm.work_time"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"意向工作城市",prop:"city_id"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.subForm.city_id,callback:function(t){e.$set(e.subForm,"city_id",t)},expression:"subForm.city_id"}},e._l(e.base_city,function(e){return r("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"所在地址",prop:"address"}},[r("el-input",{attrs:{placeholder:"请输入所在地址"},model:{value:e.subForm.address,callback:function(t){e.$set(e.subForm,"address",t)},expression:"subForm.address"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"经度",prop:"lng"}},[r("el-input",{attrs:{placeholder:"请输入经度"},model:{value:e.subForm.lng,callback:function(t){e.$set(e.subForm,"lng",t)},expression:"subForm.lng"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"纬度",prop:"lat"}},[r("el-input",{attrs:{placeholder:"请输入纬度"},model:{value:e.subForm.lat,callback:function(t){e.$set(e.subForm,"lat",t)},expression:"subForm.lat"}}),e._v(" "),r("lb-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(t){e.showMap=!0}}},[e._v("获取经纬度")])],1),e._v(" "),r("el-form-item",{attrs:{label:"技师简介",prop:"text"}},[r("el-input",{attrs:{type:"textarea",rows:10,maxlength:"300",resize:"none","show-word-limit":"",placeholder:"请输入技师简介"},model:{value:e.subForm.text,callback:function(t){e.$set(e.subForm,"text",t)},expression:"subForm.text"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"身份证号",prop:"id_code"}},[r("el-input",{attrs:{placeholder:"请输入身份证号"},model:{value:e.subForm.id_code,callback:function(t){e.$set(e.subForm,"id_code",t)},expression:"subForm.id_code"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"身份证照片",prop:"id_card"}},[r("lb-cover",{attrs:{fileList:e.subForm.id_card,fileType:"image",type:"more",fileSize:3},on:{selectedFiles:function(t){return e.getBannerList(t,"id_card")}}}),e._v(" "),r("lb-tool-tips",[e._v("请分别上传身份证人像面、身份证国徽面、手持身份证照片")])],1),e._v(" "),r("el-form-item",{attrs:{label:"资格证书",prop:"license"}},[r("lb-cover",{attrs:{fileList:e.subForm.license,fileType:"image",type:"more",fileSize:15},on:{selectedFiles:function(t){return e.getBannerList(t,"license")}}})],1),e._v(" "),r("el-form-item",{attrs:{label:"工作形象照",prop:"work_img"}},[r("lb-cover",{attrs:{fileList:e.subForm.work_img},on:{selectedFiles:function(t){return e.getCover(t,"work_img")}}}),e._v(" "),r("lb-tool-tips",[e._v("图片建议尺寸: 216 * 216")])],1),e._v(" "),r("el-form-item",{attrs:{label:"个人生活照",prop:"self_img"}},[r("lb-cover",{attrs:{fileList:e.subForm.self_img,fileType:"image",type:"more",tips:"750 * n",fileSize:9},on:{selectedFiles:function(t){return e.getBannerList(t,"self_img")}}})],1),e._v(" "),r("el-form-item",{attrs:{label:"个人视频介绍",prop:"video"}},[r("div",{staticClass:"upload-file-warp"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.subForm.video,expression:"subForm.video"}],staticClass:"choice-file-input",attrs:{type:"text",placeholder:"请选择视频"},domProps:{value:e.subForm.video},on:{input:function(t){t.target.composing||e.$set(e.subForm,"video",t.target.value)}}}),e._v(" "),r("lb-cover",{attrs:{type:"button",fileType:"video",fileSize:1},on:{selectedFiles:e.getVoice}})],1)]),e._v(" "),r("el-form-item",{attrs:{label:"虚拟订单量",prop:"order_num"}},[r("el-input",{attrs:{placeholder:"请输入虚拟订单量"},model:{value:e.subForm.order_num,callback:function(t){e.$set(e.subForm,"order_num",e._n(t))},expression:"subForm.order_num"}})],1),e._v(" "),r("el-form-item",[r("lb-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v(e._s(e.$t("action.submit")))]),e._v(" "),r("lb-button",{on:{click:function(t){return e.$router.back(-1)}}},[e._v(e._s(e.$t("action.back")))])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"关联用户",visible:e.showDialog,width:"800px",center:""},on:{"update:visible":function(t){e.showDialog=t}}},[r("el-form",{ref:"searchForm",attrs:{inline:!0,model:e.searchForm,"label-width":"70px"}},[r("el-form-item",{attrs:{label:"输入查询",prop:"nickName"}},[r("el-input",{attrs:{placeholder:"请输入用户昵称/手机号"},model:{value:e.searchForm.nickName,callback:function(t){e.$set(e.searchForm,"nickName",t)},expression:"searchForm.nickName"}})],1),e._v(" "),r("el-form-item",[r("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.getTableDataList(1)}}},[e._v(e._s(e.$t("action.search")))]),e._v(" "),r("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",icon:"el-icon-refresh-left"},on:{click:function(t){return e.resetForm("searchForm")}}},[e._v(e._s(e.$t("action.reset")))])],1)],1),e._v(" "),r("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-style":{background:"#f5f7fa",color:"#606266"},"tooltip-effect":"dark","highlight-current-row":""},on:{"current-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{prop:"id",label:"用户ID"}}),e._v(" "),r("el-table-column",{attrs:{prop:"avatarUrl",label:"头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[r("lb-image",{attrs:{src:e.row.avatarUrl}})]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"nickName",label:"昵称"}}),e._v(" "),r("el-table-column",{attrs:{prop:"phone",label:"手机号"}})],1),e._v(" "),r("lb-page",{attrs:{batch:!1,page:e.searchForm.page,pageSize:e.searchForm.limit,total:e.total},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}}),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.showDialog=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleDialogConfirm}},[e._v("确 定")])],1)],1),e._v(" "),r("lb-map",{attrs:{dialogVisible:e.showMap},on:{"update:dialogVisible":function(t){e.showMap=t},"update:dialog-visible":function(t){e.showMap=t},selectedLatLng:e.getLatLng}})],1)],1)},staticRenderFns:[]};var b=r("VU/8")(m,d,!1,function(e){r("h7qd")},"data-v-58337ca6",null);t.default=b.exports},h7qd:function(e,t){}});