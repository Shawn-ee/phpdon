webpackJsonp([59],{"/qUM":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Xxa5"),r=a.n(n),i=a("exGp"),s=a.n(i),o=a("PJh5"),d=a.n(o),l={inject:["reload"],data:function(){return{isLoad:!1,firstLoading:!1,loading:!1,upgradeInfo:{},isWe7:window.lbConfig.isWe7}},created:function(){this.getDetail()},methods:{getDetail:function(){var e=this;return s()(r.a.mark(function t(){var a,n,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.firstLoading=!0,t.next=3,e.$api.system.getUpgradeInfo();case 3:if(a=t.sent,n=a.code,i=a.data,e.firstLoading=!1,200===n){t.next=9;break}return t.abrupt("return");case 9:e.upgradeInfo=i,e.isLoad=!0;case 11:case"end":return t.stop()}},t,e)}))()},confirmUpdate:function(){var e=this;this.$confirm("更新系统将覆盖服务器里面的代码文件，请谨慎操作，是否要更新？",this.$t("tips.reminder"),{confirmButtonText:this.$t("action.comfirm"),cancelButtonText:this.$t("action.cancel"),type:"warning"}).then(function(){e.updateSysVersion()})},updateSysVersion:function(){var e=this;return s()(r.a.mark(function t(){var a,n,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$api.system.upgrade();case 3:if(a=t.sent,n=a.code,i=a.data,e.loading=!1,200===n){t.next=9;break}return t.abrupt("return");case 9:if(!i.code||-1!==i.code){t.next=12;break}return e.$message.error(i.msg),t.abrupt("return");case 12:return e.$message.success("更新成功！"),t.next=15,e.$api.base.clearCache();case 15:window.location.reload();case 16:case"end":return t.stop()}},t,e)}))()}},filters:{handleTime:function(e,t){return 1===t?d()(1e3*e).format("YYYY-MM-DD"):2===t?d()(1e3*e).format("HH:mm:ss"):d()(1e3*e).format("YYYY-MM-DD HH:mm:ss")}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"lb-system-wechat"},[a("top-nav"),e._v(" "),e.isLoad?a("div",{staticClass:"page-main"},[a("lb-tips",[e._v("更新系统将覆盖服务器里面的代码文件，请谨慎操作")]),e._v(" "),e.upgradeInfo&&2e4===e.upgradeInfo.code?a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.firstLoading,expression:"firstLoading"}],staticClass:"config-form",attrs:{model:e.upgradeInfo,"label-width":"150px"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("lb-classify-title",{attrs:{title:"基本信息"}}),e._v(" "),a("div",{staticStyle:{height:"20px"}}),e._v(" "),a("el-form-item",{attrs:{label:"授权域名："}},[a("span",[e._v(e._s(e.upgradeInfo.data.domain.url))])]),e._v(" "),a("el-form-item",{attrs:{label:"授权使用时间："}},[a("span",[e._v(e._s(e._f("handleTime")(e.upgradeInfo.data.domain.use_time)))])]),e._v(" "),a("el-form-item",{attrs:{label:"更新到期时间："}},[a("span",[e._v(e._s(e._f("handleTime")(e.upgradeInfo.data.domain.update_service_time)))])]),e._v(" "),a("div",{staticStyle:{height:"20px"}}),e._v(" "),e.upgradeInfo.data.version?a("div",[a("lb-classify-title",{attrs:{title:"版本更新"}}),e._v(" "),a("el-form-item",{attrs:{label:"创建时间："}},[a("span",[e._v(e._s(e.upgradeInfo.data.version.create_time))])]),e._v(" "),a("el-form-item",{attrs:{label:"版本名称："}},[a("span",[e._v(e._s(e.upgradeInfo.data.version.title))])]),e._v(" "),a("el-form-item",{attrs:{label:"更新说明："}},[a("el-input",{attrs:{type:"textarea","show-word-limit":"",autosize:"",readonly:!0,resize:"none"},model:{value:e.upgradeInfo.data.version.description,callback:function(t){e.$set(e.upgradeInfo.data.version,"description",t)},expression:"upgradeInfo.data.version.description"}})],1)],1):e._e(),e._v(" "),a("div",{staticStyle:{height:"20px"}}),e._v(" "),a("lb-classify-title",{attrs:{title:"版本号"}}),e._v(" "),a("div",{staticStyle:{height:"20px"}}),e._v(" "),a("el-form-item",{attrs:{label:"当前版本："}},[a("span",[e._v(e._s(e.upgradeInfo.location_version_no))])]),e._v(" "),e.upgradeInfo.data.version?a("el-form-item",{attrs:{label:"最新版本："}},[a("span",[e._v(e._s(e.upgradeInfo.data.version.no))]),e._v(" "),!0===e.upgradeInfo.is_upgrade&&e.upgradeInfo.location_version_no!==e.upgradeInfo.data.version.no?a("lb-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"danger",loading:e.loading,plain:""},on:{click:e.confirmUpdate}},[e._v("更新系统")]):e._e()],1):e._e(),e._v(" "),a("div",{staticStyle:{height:"30px"}})],1):e._e(),e._v(" "),e.upgradeInfo&&e.upgradeInfo.msg?a("block",[a("lb-tips",[e._v(e._s(e.upgradeInfo.msg))])],1):e._e()],1):e._e()],1)},staticRenderFns:[]};var f=a("VU/8")(l,c,!1,function(e){a("yZzZ")},"data-v-523888ef",null);t.default=f.exports},yZzZ:function(e,t){}});