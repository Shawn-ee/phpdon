webpackJsonp([61],{"0OJD":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("Xxa5"),a=s.n(r),n=s("exGp"),i=s.n(n),o=s("PJh5"),l=s.n(o),u={data:function(){return{loading:!1,navTitle:"",carType:{0:"公交/地铁",1:"出租车"},statusType:{1:"退款申请中",2:"同意退款",3:"拒绝退款"},subForm:{id:0},dialogRefund:!1,refundMoney:"",lockRefund:!1}},created:function(){var e=this.$route.query.id;this.getDetail(e)},methods:{getDetail:function(e){var t=this;return i()(a.a.mark(function s(){var r,n,i;return a.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,t.$api.shop.refundOrderInfo({id:e});case 2:if(r=s.sent,n=r.code,i=r.data,200===n){s.next=7;break}return s.abrupt("return");case 7:t.subForm=i;case 8:case"end":return s.stop()}},s,t)}))()},showRefundDialog:function(){var e=this.subForm.apply_price;this.refundTotalMoney=e,this.refundMoney=e,this.dialogRefund=!0},toPassRefund:function(){var e=this;return i()(a.a.mark(function t(){var s,r,n,i,o,l;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.lockRefund){t.next=2;break}return t.abrupt("return");case 2:if(s=e.subForm,r=s.id,n=s.apply_price,i=e.refundMoney,o={id:r,price:i,text:""},!(0===n&&0===i||i>0&&i<=n&&/^(([1-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/.test(i))){t.next=21;break}return t.next=9,e.$api.shop.passRefund(o);case 9:if(l=t.sent,200===l.code){t.next=13;break}return t.abrupt("return");case 13:return e.$message.success(e.$t("tips.successSub")),e.dialogRefund=!1,e.refundMoney="",t.next=18,e.getDetail(r);case 18:e.lockRefund=!1,t.next=22;break;case 21:e.$message.error("请核对金额再提交！");case 22:case"end":return t.stop()}},t,e)}))()},toRefuse:function(){var e=this;this.$confirm(this.$t("tips.confirmNoRefund"),this.$t("tips.reminder"),{confirmButtonText:this.$t("action.comfirm"),cancelButtonText:this.$t("action.cancel"),type:"warning"}).then(function(){e.refuseRefund()}).catch(function(){})},refuseRefund:function(){var e=this;return i()(a.a.mark(function t(){var s,r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=e.subForm.id,t.next=3,e.$api.shop.noPassRefund({id:s,text:""});case 3:if(r=t.sent,200===r.code){t.next=7;break}return t.abrupt("return");case 7:return e.$message.success(e.$t("tips.successOper")),t.next=10,e.getDetail(s);case 10:case"end":return t.stop()}},t,e)}))()}},watch:{$route:function(e){var t=this;return i()(a.a.mark(function s(){var r,n;return a.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:r=e.query.id,1*(n=void 0===r?0:r)!==t.subForm.id&&t.getDetail(n);case 2:case"end":return s.stop()}},s,t)}))()}},filters:{handleTime:function(e,t){return 1===t?l()(1e3*e).format("YYYY-MM-DD"):2===t?l()(1e3*e).format("HH:mm:ss"):l()(1e3*e).format("YYYY-MM-DD HH:mm:ss")}}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"lb-shop-order-edit"},[s("top-nav",{attrs:{isBack:!0}}),e._v(" "),s("div",{staticClass:"page-main"},[s("lb-tips",{attrs:{isIcon:!1}},[s("div",{staticClass:"flex-y-center"},[e._v("\n        "+e._s(e.statusType[e.subForm.status])+"\n        "),2===e.subForm.status?s("div",{staticClass:"flex-y-center"},[e._v("\n          ，退款金额：¥"+e._s(e.subForm.refund_price)+"\n          "),e.subForm.car_price?s("div",{staticClass:"ml-md"},[e._v("\n            含车费：¥"+e._s(e.subForm.car_price)+"\n          ")]):e._e()]):e._e()])]),e._v(" "),s("el-form",{attrs:{model:e.subForm,"label-width":"130px",size:"mini"},nativeOn:{submit:function(e){e.preventDefault()}}},[s("lb-classify-title",{attrs:{title:"用户信息"}}),e._v(" "),s("el-form-item",{attrs:{label:"用户ID："}},[s("div",[e._v(e._s(e.subForm.user_id))])]),e._v(" "),s("el-form-item",{attrs:{label:"姓名："}},[s("div",[e._v(e._s(e.subForm.address_info.user_name))])]),e._v(" "),s("el-form-item",{attrs:{label:"手机号："}},[s("div",[e._v(e._s(e.subForm.address_info.mobile))])]),e._v(" "),e.subForm.is_add?e._e():s("el-form-item",{attrs:{label:"车费详情："}},[s("div",{staticClass:"flex-y-center"},[e._v("\n          "+e._s(e.carType[e.subForm.car_type])+"\n          "),1==e.subForm.car_type?s("div",{staticClass:"ml-md"},[e._v("\n            全程"+e._s(e.subForm.distance)+"，车费¥"+e._s(e.subForm.pay_car_price)+"\n          ")]):e._e()])]),e._v(" "),s("el-form-item",{attrs:{label:"服务地址："}},[s("div",[e._v("\n          "+e._s(""+e.subForm.address_info.address+e.subForm.address_info.address_info)+"\n        ")])]),e._v(" "),s("lb-classify-title",{attrs:{title:"技师信息"}}),e._v(" "),s("el-form-item",{attrs:{label:"技师："}},[s("div",[e._v(e._s(e.subForm.coach_info.coach_name))])]),e._v(" "),s("el-form-item",{attrs:{label:"技师头像："}},[s("lb-cover",{attrs:{fileList:[{url:e.subForm.coach_info.work_img}],isToDel:!1,size:"small",type:"more",fileSize:1}})],1),e._v(" "),s("lb-classify-title",{attrs:{title:"订单信息"}}),e._v(" "),s("el-form-item",{attrs:{label:"付款订单号："}},[s("div",[e._v(e._s(e.subForm.pay_order_code))])]),e._v(" "),s("el-form-item",{attrs:{label:"退款订单号："}},[s("div",[e._v(e._s(e.subForm.order_code))])]),e._v(" "),e.subForm.out_refund_no?s("el-form-item",{attrs:{label:"微信退款订单号："}},[s("div",[e._v(e._s(e.subForm.out_refund_no))])]):e._e(),e._v(" "),s("el-form-item",{attrs:{label:"提交时间："}},[s("div",[e._v(e._s(e.subForm.create_time))])]),e._v(" "),1!==e.subForm.status?s("el-form-item",{attrs:{label:"审核时间："}},[s("div",[e._v(e._s(e.subForm.refund_time))])]):e._e(),e._v(" "),s("el-form-item",{attrs:{label:"退款原因："}},[s("div",[e._v(e._s(e.subForm.text))])]),e._v(" "),e.subForm.imgs&&e.subForm.imgs.length>0?s("el-form-item",{attrs:{label:"上传图片："}},[s("div",{staticClass:"flex-warp"},e._l(e.subForm.imgs,function(e,t){return s("div",{key:t,staticClass:"mr-md"},[s("lb-image",{attrs:{src:e}})],1)}),0)]):e._e(),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1===e.subForm.status,expression:"subForm.status === 1"}],attrs:{label:"处理退款："}},[s("lb-button",{attrs:{size:"mini",plain:"",type:"danger"},on:{click:e.toRefuse}},[e._v("拒绝退款")]),e._v(" "),s("lb-button",{attrs:{size:"mini",plain:"",type:"success"},on:{click:e.showRefundDialog}},[e._v("立即退款")])],1)],1),e._v(" "),s("lb-classify-title",{attrs:{title:"退款服务"}}),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.subForm.order_goods,"header-cell-style":{background:"#f5f7fa",color:"#606266"}}},[s("el-table-column",{attrs:{prop:"goods_cover",label:"服务图片"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("lb-image",{attrs:{src:e.row.goods_cover}})]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"goods_name",label:"服务名称"}}),e._v(" "),s("el-table-column",{attrs:{prop:"time_long",label:"服务时长"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.time_long?t.row.time_long+"分钟":"")+"\n        ")]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"num",label:"服务数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.num||1)+"\n        ")]}}])})],1),e._v(" "),s("div",{staticClass:"space-lg mt-lg mb-lg"},[e._v("\n      合计数量："+e._s(e.subForm.all_goods_num||1)+"\n    ")]),e._v(" "),s("lb-button",{attrs:{type:"primary"},on:{click:function(t){return e.$router.back(-1)}}},[e._v(e._s(e.$t("action.back")))]),e._v(" "),s("el-dialog",{attrs:{title:"立即退款",visible:e.dialogRefund,width:"400px",center:""},on:{"update:visible":function(t){e.dialogRefund=t}}},[s("div",{staticClass:"refund-inner"},[s("lb-tips",{attrs:{isIcon:!1}},[e._v("请核对信息后输入需要退款的金额")]),e._v(" "),s("el-input",{staticStyle:{width:"100%"},attrs:{disabled:1*e.refundTotalMoney==0,placeholder:"请输入退款金额"},model:{value:e.refundMoney,callback:function(t){e.refundMoney=t},expression:"refundMoney"}}),e._v(" "),s("p",{staticClass:"mt-lg"},[e._v("\n          实际可退款金额\n          "),s("span",{staticClass:"c-warning"},[e._v("￥"+e._s(e.refundTotalMoney))])]),e._v(" "),s("p",[e._v("退款金额不能大于可退款金额")])],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogRefund=!1}}},[e._v(e._s(e.$t("action.cancel")))]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.toPassRefund}},[e._v("确认退款")])],1)])],1)],1)},staticRenderFns:[]};var d=s("VU/8")(u,c,!1,function(e){s("qMfH")},"data-v-4d359733",null);t.default=d.exports},qMfH:function(e,t){}});