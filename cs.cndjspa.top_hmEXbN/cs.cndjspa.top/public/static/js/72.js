webpackJsonp([72],{KCnm:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("mvHQ"),i=a.n(s),r=a("Xxa5"),n=a.n(r),o=a("exGp"),l=a.n(o),c=a("Dd8w"),u=a.n(c),m=a("NYxO"),p=a("PJh5"),d=a.n(p),_={data:function(){var t=this;return{userInfo:{},loading:!1,userTypeList:[{id:0,title:"全部"},{id:1,title:"已认证"},{id:2,title:"未认证"}],addText:{0:{type:"info",text:"用户"},1:{type:"",text:"平台"}},statusText:{1:{type:"info",text:"申请中"},2:{type:"",text:"已授权"},3:{type:"danger",text:"取消授权"},4:{type:"danger",text:"已驳回"}},pickerOptions:{disabledDate:function(t){return t.getTime()>1e3*(d()(d()(Date.now()).format("YYYY-MM-DD")).unix()+86400-1)}},searchForm:{page:1,limit:10,status:0,is_user:0,start_time:"",end_time:"",name:""},tableData:[],total:0,count:{},showApply:!1,applyForm:{title:"",status:"",sh_text:""},subForm:{id:0,status:0,sh_text:"",type:1},subFormRules:{status:{required:!0,validator:function(e,a,s){t.subForm.status?s():s(new Error("请选择审核结果"))},trigger:"blur"}},franchiseeList:[],franchiseeDialog:!1,admin_id:"",editInfo:{admin_id:""}}},created:function(){this.userInfo=JSON.parse(window.localStorage.getItem("massage_userInfo")),this.getBaseInfo()},activated:function(){this.getTableDataList(1)},computed:u()({},Object(m.d)({routesItem:function(t){return t.routes}})),methods:{getBaseInfo:function(){var t=this;return l()(n.a.mark(function e(){var a,s,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$api.agent.adminSelect();case 2:if(a=e.sent,s=a.code,i=a.data,200===s){e.next=7;break}return e.abrupt("return");case 7:t.franchiseeList=i;case 8:case"end":return e.stop()}},e,t)}))()},resetForm:function(t){this.$refs[t].resetFields(),this.getTableDataList(1)},handleSizeChange:function(t){this.searchForm.limit=t,this.handleCurrentChange(1)},handleCurrentChange:function(t){this.searchForm.page=t,this.getTableDataList()},toChange:function(t){var e=this;return l()(n.a.mark(function a(){return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e.searchForm.status=t,e.getTableDataList(1);case 2:case"end":return a.stop()}},a,e)}))()},getTableDataList:function(t){var e=this;return l()(n.a.mark(function a(){var s,r,o,l,c,u,m,p,d,_,f;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t&&(e.searchForm.page=1),e.loading=!0,s=JSON.parse(i()(e.searchForm)),(r=s.start_time)&&r.length>0?(s.start_time=r[0]/1e3,s.end_time=r[1]/1e3):(s.start_time="",s.end_time=""),-1===s.status&&(s.is_update=1,delete s.status),a.next=8,e.$api.technician.coachList(s);case 8:if(o=a.sent,l=o.code,c=o.data,e.loading=!1,200===l){a.next=14;break}return a.abrupt("return");case 14:u=c.all,m=c.nopass,p=c.ing,d=c.pass,_=c.total,f=c.update_num,e.tableData=c.data,e.total=_,e.count={all:u,nopass:m,ing:p,pass:d,update:f};case 18:case"end":return a.stop()}},a,e)}))()},toShowApply:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return l()(n.a.mark(function s(){var i,r,o,l;return n.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i=2===a?"coachUpdateInfo":"coachInfo",s.next=3,t.$api.technician[i]({id:e});case 3:if(r=s.sent,o=r.code,l=r.data,200===o){s.next=8;break}return s.abrupt("return");case 8:["id_card","license","self_img"].map(function(t){l[t]=l[t].length>0?l[t].map(function(t){return{url:t}}):[]}),l.text=l.text?l.text.replace(/\n/g,"<br>"):"-",t.applyForm=l,t.subForm={id:e,status:2,sh_text:"",type:a},t.showApply=!t.showApply;case 14:case"end":return s.stop()}},s,t)}))()},confirmDel:function(t,e){var a=this;this.$confirm(this.$t(3===e?"tips.confirmNoPass":"tips.confirmDelete"),this.$t("tips.reminder"),{confirmButtonText:this.$t("action.comfirm"),cancelButtonText:this.$t("action.cancel"),type:"warning"}).then(function(){a.updateItem(1,t,e)}).catch(function(){})},updateItem:function(t,e,a){var s=this;return l()(n.a.mark(function i(){var r;return n.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:r=1===t?{id:e,status:a}:{id:e,recommend:a},s.$api.technician.coachUpdate(r).then(function(t){if(200===t.code)s.$message.success(s.$t(-1===a?"tips.successDel":"tips.successOper")),-1===a&&(s.searchForm.page=s.searchForm.page<Math.ceil((s.total-1)/s.searchForm.limit)?s.searchForm.page:Math.ceil((s.total-1)/s.searchForm.limit)),s.getTableDataList();else{if(-1===a)return;s.getTableDataList()}});case 2:case"end":return i.stop()}},i,s)}))()},submitForm:function(){var t=this;this.$refs.subForm.validate(function(e){if(e){var a=JSON.parse(i()(t.subForm)),s=2===a.type?"coachUpdateCheck":"coachUpdate";delete a.type,t.$api.technician[s](a).then(function(e){200===e.code&&(t.$message.success(t.$t("tips.successSub")),t.showApply=!1,t.getTableDataList())})}})},confirmedit:function(t){var e=JSON.parse(i()(t));0===e.admin_id&&(e.admin_id=""),this.editInfo=e,this.franchiseeDialog=!0},submitFranchisee:function(){var t=this,e=this.editInfo,a=e.id,s=e.admin_id,i=void 0===s?0:s;i?this.$api.technician.coachUpdate({id:a,admin_id:i}).then(function(e){200===e.code&&(t.$message.success(t.$t("tips.successOper")),t.franchiseeDialog=!1,t.getTableDataList())}):this.$message.error("请选择代理商")}},filters:{handleTime:function(t,e){return 1===e?d()(1e3*t).format("YYYY-MM-DD"):2===e?d()(1e3*t).format("HH:mm:ss"):d()(1e3*t).format("YYYY-MM-DD HH:mm:ss")}}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"lb-examine"},[a("top-nav"),t._v(" "),a("div",{staticClass:"page-main"},[a("el-row",{staticClass:"page-top-operate"},[a("lb-button",{attrs:{size:"medium",type:"primary",icon:"el-icon-plus"},on:{click:function(e){return t.$router.push("/technician/edit")}}},[t._v(t._s(t.$t("menu.TechnicianAdd")))])],1),t._v(" "),a("el-row",{staticClass:"page-top-operate"},[a("el-button",{attrs:{type:0===t.searchForm.status?"primary":"",plain:"",size:"medium"},on:{click:function(e){return t.toChange(0)}}},[t._v("全部（"+t._s(t.count.all||0)+"）")]),t._v(" "),a("el-button",{attrs:{type:1===t.searchForm.status?"primary":"",plain:"",size:"medium"},on:{click:function(e){return t.toChange(1)}}},[t._v("申请中（"+t._s(t.count.ing||0)+"）")]),t._v(" "),a("el-button",{attrs:{type:2===t.searchForm.status?"primary":"",plain:"",size:"medium"},on:{click:function(e){return t.toChange(2)}}},[t._v("已授权（"+t._s(t.count.pass||0)+"）")]),t._v(" "),a("el-button",{attrs:{type:4===t.searchForm.status?"primary":"",plain:"",size:"medium"},on:{click:function(e){return t.toChange(4)}}},[t._v("已驳回（"+t._s(t.count.nopass||0)+"）")]),t._v(" "),a("el-button",{attrs:{type:-1===t.searchForm.status?"primary":"",plain:"",size:"medium"},on:{click:function(e){return t.toChange(-1)}}},[t._v("重新审核（"+t._s(t.count.update||0)+"）")])],1),t._v(" "),a("el-row",{staticClass:"page-search-form"},[a("el-form",{ref:"searchForm",attrs:{inline:!0,model:t.searchForm},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"输入查询",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入技师姓名/手机号"},model:{value:t.searchForm.name,callback:function(e){t.$set(t.searchForm,"name",e)},expression:"searchForm.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"申请时间",prop:"start_time"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"timestamp","picker-options":t.pickerOptions,"default-time":["00:00:00","23:59:59"]},on:{change:function(e){return t.getTableDataList(1)}},model:{value:t.searchForm.start_time,callback:function(e){t.$set(t.searchForm,"start_time",e)},expression:"searchForm.start_time"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"认证状态",prop:"is_user"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(e){return t.getTableDataList(1)}},model:{value:t.searchForm.is_user,callback:function(e){t.$set(t.searchForm,"is_user",e)},expression:"searchForm.is_user"}},t._l(t.userTypeList,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1),t._v(" "),a("el-form-item",[a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.getTableDataList(1)}}},[t._v(t._s(t.$t("action.search")))]),t._v(" "),a("lb-button",{staticStyle:{"margin-right":"5px"},attrs:{size:"medium",icon:"el-icon-refresh-left"},on:{click:function(e){return t.resetForm("searchForm")}}},[t._v(t._s(t.$t("action.reset")))])],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,"header-cell-style":{background:"#f5f7fa",color:"#606266"}}},[a("el-table-column",{attrs:{prop:"id",label:"ID",fixed:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"work_img",label:"技师头像","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("lb-image",{attrs:{src:t.row.work_img}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"coach_name",label:"姓名","min-width":"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"手机号","min-width":"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"create_time",label:"申请时间","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(t._f("handleTime")(e.row.create_time,1)))]),t._v(" "),a("p",[t._v(t._s(t._f("handleTime")(e.row.create_time,2)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"admin_add",label:"申请人"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t.addText[e.row.admin_add].type}},[t._v(t._s(t.addText[e.row.admin_add].text))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"认证状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.user_id?a("el-tag",[t._v("已认证")]):t._e(),t._v(" "),e.row.user_id?t._e():a("el-tag",{attrs:{type:"danger"}},[t._v("暂未认证")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t.statusText[e.row.status].type}},[t._v("\n            "+t._s(t.statusText[e.row.status].text)+"\n          ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"admin_name",label:"所属代理商","min-width":"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"当前定位","min-width":"200"}}),t._v(" "),t.routesItem.auth.recommend?a("el-table-column",{attrs:{prop:"status",label:"设为推荐","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{disabled:0===t.userInfo.is_admin,"active-value":1,"inactive-value":0},on:{change:function(a){return t.updateItem(2,e.row.id,e.row.recommend)}},model:{value:e.row.recommend,callback:function(a){t.$set(e.row,"recommend",a)},expression:"scope.row.recommend"}})]}}],null,!1,1560939959)}):t._e(),t._v(" "),a("el-table-column",{attrs:{label:"操作","min-width":"220"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"table-operate"},[1!==e.row.is_update?a("lb-button",{attrs:{size:"mini",plain:"",type:"primary"},on:{click:function(a){return t.$router.push("/technician/edit?id="+e.row.id)}}},[t._v(t._s(t.$t("action.edit")))]):t._e(),t._v(" "),1==t.userInfo.is_admin?a("block",[1===e.row.is_update?a("lb-button",{attrs:{size:"mini",plain:"",type:"danger"},on:{click:function(a){return t.toShowApply(e.row.id,2)}}},[t._v("重新审核")]):t._e(),t._v(" "),1!==e.row.status?a("lb-button",{attrs:{size:"mini",plain:"",type:"danger"},on:{click:function(a){return t.confirmDel(e.row.id,-1)}}},[t._v(t._s(t.$t("action.delete")))]):t._e(),t._v(" "),1===e.row.status||3==e.row.status?a("lb-button",{attrs:{size:"mini",plain:"",type:"success"},on:{click:function(a){return t.toShowApply(e.row.id)}}},[t._v(t._s(1===e.row.status?"授权为技师":"重新授权为技师"))]):t._e(),t._v(" "),2===e.row.status?a("lb-button",{attrs:{size:"mini",plain:"",type:"success"},on:{click:function(a){return t.confirmDel(e.row.id,3)}}},[t._v("取消授权")]):t._e(),t._v(" "),a("lb-button",{attrs:{size:"mini",plain:"",type:"warning"},on:{click:function(a){return t.confirmedit(e.row)}}},[t._v("修改代理商")])],1):t._e()],1)]}}])})],1),t._v(" "),a("lb-page",{attrs:{batch:!1,page:t.searchForm.page,pageSize:t.searchForm.limit,total:t.total},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}}),t._v(" "),a("el-dialog",{attrs:{title:"申请详情",visible:t.showApply,width:"800px",center:""},on:{"update:visible":function(e){t.showApply=e}}},[t.showApply?a("div",{staticStyle:{height:"60vh",overflow:"auto"}},[a("el-form",{attrs:{model:t.applyForm,"label-width":"130px",size:"mini"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("div",{staticClass:"flex-warp"},[a("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"用户ID："}},[a("div",[t._v(t._s(t.applyForm.user_id))])]),t._v(" "),a("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"昵称："}},[a("div",[t._v(t._s(t.applyForm.nickName))])])],1),t._v(" "),a("el-form-item",{attrs:{label:"姓名："}},[a("div",[t._v(t._s(t.applyForm.coach_name))])]),t._v(" "),a("el-form-item",{attrs:{label:"性别："}},[a("div",[t._v(t._s(0===t.applyForm.sex?"男":"女"))])]),t._v(" "),a("el-form-item",{attrs:{label:"手机号："}},[a("div",[t._v(t._s(t.applyForm.mobile))])]),t._v(" "),a("el-form-item",{attrs:{label:"从业年份："}},[a("div",[t._v(t._s(t.applyForm.work_time)+"年")])]),t._v(" "),a("el-form-item",{attrs:{label:"意向工作城市："}},[a("div",[t._v(t._s(t.applyForm.city))])]),t._v(" "),a("el-form-item",{attrs:{label:"所在地址："}},[a("div",[t._v(t._s(t.applyForm.address))])]),t._v(" "),a("el-form-item",{attrs:{label:"技师简介："}},[a("div",{domProps:{innerHTML:t._s(t.applyForm.text)}})]),t._v(" "),a("el-form-item",{attrs:{label:"身份证号："}},[a("div",[t._v(t._s(t.applyForm.id_code))])]),t._v(" "),a("el-form-item",{attrs:{label:"身份证正反面："}},[a("div",{staticClass:"flex-warp"},[a("lb-cover",{attrs:{fileList:t.applyForm.id_card,isToDel:!1,size:"small",type:"more",fileSize:t.applyForm.id_card.length}})],1)]),t._v(" "),a("el-form-item",{attrs:{label:"资格证书："}},[a("div",{staticClass:"flex-warp"},[a("lb-cover",{attrs:{fileList:t.applyForm.license,isToDel:!1,size:"small",type:"more",fileSize:t.applyForm.license.length}})],1)]),t._v(" "),a("el-form-item",{attrs:{label:"工作形象照："}},[a("div",{staticClass:"flex-warp"},[a("lb-cover",{attrs:{fileList:[{url:t.applyForm.work_img}],isToDel:!1,size:"small",type:"more",fileSize:1}})],1)]),t._v(" "),a("el-form-item",{attrs:{label:"个人生活照："}},[a("div",{staticClass:"flex-warp"},[a("lb-cover",{attrs:{fileList:t.applyForm.self_img,isToDel:!1,size:"small",type:"more",fileSize:t.applyForm.self_img.length}})],1)]),t._v(" "),t.applyForm.video?a("el-form-item",{attrs:{label:"个人视频介绍："}},[a("video",{attrs:{controls:"",width:"500",height:"300",src:t.applyForm.video}})]):t._e(),t._v(" "),a("div",{staticClass:"space-lg"}),t._v(" "),a("div",{staticClass:"space-lg b-1px-t"}),t._v(" "),a("div",{staticClass:"space-lg"}),t._v(" "),1!==t.applyForm.status?a("block",[a("div",{staticClass:"flex-warp"},[a("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"审核结果：",prop:"status"}},[a("el-tag",{attrs:{type:t.statusText[t.applyForm.status].type}},[t._v(t._s(t.statusText[t.applyForm.status].text))])],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1!=t.applyForm.status&&t.applyForm.sh_time,expression:"applyForm.status != 1 && applyForm.sh_time"}],staticStyle:{width:"50%"},attrs:{label:"审核时间：",prop:""}},[a("div",{staticClass:"c-warning"},[t._v("\n                  "+t._s(t._f("handleTime")(t.applyForm.sh_time))+"\n                ")])])],1),t._v(" "),t.applyForm.sh_text?a("el-form-item",{attrs:{label:"审核意见：",prop:"sh_text"}},[a("div",[t._v(t._s(t.applyForm.sh_text))])]):t._e()],1):t._e()],1),t._v(" "),1===t.applyForm.status||3==t.applyForm.status?a("el-form",{ref:"subForm",attrs:{model:t.subForm,rules:t.subFormRules,"label-width":"130px",size:"mini"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"审核结果：",prop:"status"}},[a("el-radio-group",{model:{value:t.subForm.status,callback:function(e){t.$set(t.subForm,"status",e)},expression:"subForm.status"}},[a("el-radio",{attrs:{label:2}},[t._v("通过")]),t._v(" "),1===t.applyForm.status?a("el-radio",{attrs:{label:4}},[t._v("驳回")]):t._e()],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"审核意见："}},[a("el-input",{attrs:{type:"textarea",rows:10,maxlength:"300","show-word-limit":"",resize:"none",placeholder:"请输入审核意见"},model:{value:t.subForm.sh_text,callback:function(e){t.$set(t.subForm,"sh_text",e)},expression:"subForm.sh_text"}})],1)],1):t._e()],1):t._e(),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.showApply=!1}}},[t._v(t._s(t.$t("action.cancel")))]),t._v(" "),1===t.applyForm.status||3===t.applyForm.status?a("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v(t._s(t.$t("action.comfirm")))]):t._e()],1)]),t._v(" "),a("el-dialog",{attrs:{title:"选择代理商",visible:t.franchiseeDialog,width:"520px",center:""},on:{"update:visible":function(e){t.franchiseeDialog=e}}},[a("div",{staticClass:"f_r_m_c",staticStyle:{width:"100%"}},[a("span",[t._v("代理商：")]),t._v(" "),a("div",{staticClass:"f1",staticStyle:{width:"0"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.editInfo.admin_id,callback:function(e){t.$set(t.editInfo,"admin_id",e)},expression:"editInfo.admin_id"}},t._l(t.franchiseeList,function(t){return a("el-option",{key:t.id,attrs:{label:t.username,value:t.id}})}),1)],1)]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.franchiseeDialog=!1}}},[t._v(t._s(t.$t("action.cancel")))]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.submitFranchisee}},[t._v(t._s(t.$t("action.comfirm")))])],1)])],1)],1)},staticRenderFns:[]};var h=a("VU/8")(_,f,!1,function(t){a("dkIA")},"data-v-25eb14f6",null);e.default=h.exports},dkIA:function(t,e){}});